

<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>与第三方库协同 - React</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:title" content="与第三方库协同 - React">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://facebook.github.io/react/docs/integrating-with-other-libraries.html">
  <meta property="og:image" content="https://facebook.github.io/react/img/logo_og.png">
  <meta property="og:description" content="A JavaScript library for building user interfaces">
  <meta property="fb:app_id" content="623268441017527">

  <link rel="shortcut icon" href="/react/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="React" href="https://facebook.github.io/react/feed.xml">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" />
  <link rel="stylesheet" href="/react/css/syntax.css">
  <link rel="stylesheet" href="/react/css/codemirror.css">
  <link rel="stylesheet" href="/react/css/react.css">

  <script src="https://use.typekit.net/qfl6nyj.js"></script>
  <script>try{Typekit.load({ async: true });}catch(e){}</script>

  <!--[if lte IE 8]>
  <script src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://unpkg.com/es5-shim@4.5.9/es5-shim.min.js"></script>
  <script src="https://unpkg.com/es5-shim@4.5.9/es5-sham.min.js"></script>
  <![endif]-->
  <script src="https://unpkg.com/docsearch.js@1.5.0/dist/cdn/docsearch.min.js"></script>
  <script src="https://unpkg.com/codemirror@5.15.2"></script>
  <script src="https://unpkg.com/codemirror@5.15.2/mode/javascript/javascript.js"></script>
  <script src="https://unpkg.com/codemirror@5.15.2/mode/xml/xml.js"></script>
  <script src="https://unpkg.com/codemirror@5.15.2/mode/jsx/jsx.js"></script>
  <script src="https://unpkg.com/react/dist/react.min.js"></script>
  <script src="https://unpkg.com/react-dom/dist/react-dom.min.js"></script>
  <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
  <script src="/react/js/live_editor.js"></script>
</head>
<body>

  <div class="container">

    <div class="nav-main">
  <div class="wrap">
    <a class="nav-home" href="/react/">
      <img class="nav-logo" src="/react/img/logo.svg" width="36" height="36">
      React
    </a>
    <div class="nav-lists">
      <ul class="nav-site nav-site-internal">
        <li><a href="/react/docs/hello-world.html" class="active">文档</a></li>
        <li><a href="/react/tutorial/tutorial.html">教程</a></li>
        <li><a href="/react/community/support.html">社区</a></li>
        <li><a href="/react/blog/">博客</a></li>
        <li class="nav-site-search">
          <input id="algolia-doc-search" type="text" placeholder="搜索文档..." />
        </li>
      </ul>
      <ul class="nav-site nav-site-external">
        <li><a href="https://github.com/discountry/react" target="_blank">参与翻译</a></li>
        <li><a href="https://github.com/facebook/react" target="_blank">GitHub</a></li>
        <li><a href="https://github.com/facebook/react/releases" target="_blank">v15.5.4</a></li>
      </ul>
    </div>
  </div>
</div>


    <section class="content wrap documentationContent">
  <div class="inner-content">
    <a class="edit-page-link" href="https://github.com/discountry/react/tree/master/docs/docs/integrating-with-other-libraries.md" target="_blank">纠错</a>
    <h1>
      与第三方库协同
    </h1>
    <div class="subHeader"></div>

    <p>我们可以在任何网页应用中使用 React。不仅可以把 React 添加到其他应用里，而且只要稍作改动，我们也可以把其他应用添加到 React 项目里。本文将着重介绍如何将 React 与 <a href="https://jquery.com/">jQuery</a> 以及 <a href="http://backbonejs.org/">Backbone</a> 结合使用。当然，类似的思路同样可以应用与其他场景。</p>

<h2>与 DOM 节点操作类插件结合</h2>

<p>对于 React 之外的 DOM 节点操作，React 是不会去处理的，因为 React 内部有自己的渲染逻辑。当相同的 DOM 节点被外部的代码改变时，React 就会很迷茫，并不知道发生了什么。</p>

<p>但这也不意味着 React 无法与其他操作 DOM 节点的库一起使用，你只要清楚他们分别在做什么就可以了。</p>

<p>最简单的方式就是阻止 React 更新外部在操作的节点，那么你可以通过生成一个 React 根本不会去更新的元素来实现，比如空的 <code>&lt;div /&gt;</code>。</p>

<h3>进一步的解释</h3>

<p>为了解释得更清楚，我们先来封装一个通用的 jQuery 插件吧。</p>

<p>在这里，我们给 DOM 的根节点元素加了一个 <a href="/react/docs/refs-and-the-dom.html">ref</a>。在 <code>componentDidMount</code> 中，我们会调用这个 ref，并把它传给 jQuery 插件。</p>

<p>为了防止 React 在 DOM 加载后修改节点，我们先要在 <code>render()</code> 中返回一个空的 <code>&lt;div /&gt;</code>。这个空的 <code>&lt;div /&gt;</code> 既没有属性也没有子元素，这样一来，React 就不会更新它了。那么，我们封装的 jQuery 插件就可以随意地更新这个节点。</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kr">class</span> <span class="nx">SomePlugin</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">$el</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">);</span>
</span><span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">somePlugin</span><span class="p">();</span>
</span>  <span class="p">}</span>

  <span class="nx">componentWillUnmount</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">somePlugin</span><span class="p">(</span><span class="s1">&#39;destroy&#39;</span><span class="p">);</span>
</span>  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">el</span> <span class="o">=</span> <span class="nx">el</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">;</span>
</span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>值得注意的是，我们既调用了 <code>componentDidMount</code> 也调用了 <code>componentWillUnmount</code> <a href="/react/docs/react-component.html#the-component-lifecycle">生命周期函数</a>。由于很多 jQuery 的插件都会在 DOM 上挂载事件监听器，因此我们必须要在 <code>componentWillUnmount</code> 的时候把这个监听器删掉。如果某个插件没有提供“删除监听器”这类的方法，那你很可能需要自己写一个。为了防止内存泄漏，请务必在生命周期函数中移除插件挂载的事件监听器。</p>

<h3>集成 jQuery Chosen 插件</h3>

<p>为了进一步解释上面提到的内容，我们来封装一个 <a href="https://harvesthq.github.io/chosen/">Chosen</a> 插件，这是一个可以扩充 <code>&lt;select&gt;</code> 功能的 jQuery 插件。</p>

<blockquote>
<p><strong>注：</strong></p>

<p>尽管以下的做法是可以实现的，但这样处理，并不是最佳的解决方案。更好的方式，显然是使用 React 组件。不仅因为在 React 应用中组件的可复用性强，而且通常来说，组件的行为及外观也是更容易控制的。</p>
</blockquote>

<p>首先，我们先来看一下 Chosen 插件是如何操作 DOM 节点的。</p>

<p>如果你在 <code>&lt;select&gt;</code> 节点中调用 Chosen 插件，首先它会读取节点中原本存在的属性，然后通过添加行内样式，把 <code>&lt;select&gt;</code> 这个节点隐藏起来。接下来，Chosen 插件会在隐藏起来的这个 <code>&lt;select&gt;</code> 节点之后添加它自己定义的节点。最后，调用 jQuery，并告知我们节点已经被它改变了。</p>

<p>那么，我们就需要把上面提到的这个节点封装成 React 组件。在这里我们把它封装成 <code>&lt;Chosen&gt;</code>：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kd">function</span> <span class="nx">Example</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Chosen</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">value</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">)}</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">option</span><span class="o">&gt;</span><span class="nx">vanilla</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
      <span class="o">&lt;</span><span class="nx">option</span><span class="o">&gt;</span><span class="nx">chocolate</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
      <span class="o">&lt;</span><span class="nx">option</span><span class="o">&gt;</span><span class="nx">strawberry</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
    <span class="o">&lt;</span><span class="err">/Chosen&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>为了方便，我么先把它写成一个 <a href="/react/docs/uncontrolled-components.html">不可控组件</a>。</p>

<p>首先，我们来创建一个带有 <code>render()</code> 方法的空组件，这个组件返回用 <code>&lt;div&gt;</code> 包着的 <code>&lt;select&gt;</code>：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kr">class</span> <span class="nx">Chosen</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
<span class="hll">      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span><span class="hll">        <span class="o">&lt;</span><span class="nx">select</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;Chosen-select&quot;</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">el</span> <span class="o">=</span> <span class="nx">el</span><span class="p">}</span><span class="o">&gt;</span>
</span>          <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="err">/select&gt;</span>
      <span class="o">&lt;</span><span class="err">/div&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>需要注意，这里我们必须用一个 <code>&lt;div&gt;</code> 包着 <code>&lt;select&gt;</code>，因为 Chosen 插件会在 <code>&lt;select&gt;</code> 之后添加 DOM 元素。对于 React 来说，<code>&lt;div&gt;</code> 就应该只有一个子级元素，因此这样做就可以让 React 忽略 Chosen 插件添加的 DOM 元素，也就不会存在冲突了。请记住，如果你想让其他插件修改某一个 DOM 节点，那你一定要保证 React 不会同时修改这个节点。</p>

<p>接下来，我们需要添加生命周期函数。在 Chosen 插件初始化节点的时候，我们需要在 <code>componentDidMount</code> 里面给 <code>&lt;select&gt;</code> 节点设置一个 ref，然后在 <code>componentWillUnmount</code> 的时候删掉它：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">  <span class="k">this</span><span class="p">.</span><span class="nx">$el</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">);</span>
</span><span class="hll">  <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">chosen</span><span class="p">();</span>
</span><span class="p">}</span>

<span class="nx">componentWillUnmount</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">  <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">chosen</span><span class="p">(</span><span class="s1">&#39;destroy&#39;</span><span class="p">);</span>
</span><span class="p">}</span>
</code></pre></div>
<p><a href="http://codepen.io/gaearon/pen/qmqeQx?editors=0010">CodePen 上的示例</a></p>

<p>React 不会给 <code>this.el</code> 加上什么特殊的意义，因为我们是在 <code>render</code> 方法中，通过 <code>ref</code> 来赋值的：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="o">&lt;</span><span class="nx">select</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;Chosen-select&quot;</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">el</span> <span class="o">=</span> <span class="nx">el</span><span class="p">}</span><span class="o">&gt;</span>
</code></pre></div>
<p>现在我们的组件就可以加载了，但我们还需要处理一下值改变的情况。首先，我们需要在 Chosen 插件的 <code>&lt;select&gt;</code> 元素中&quot;订阅&quot; jQuery 的 <code>change</code> 事件。</p>

<p>我们不需要直接给 Chosen 传入 <code>this.props.onChange</code>，因为组件的 props 会随时发生变化，而且我们还需要一个处理 jQuery 事件的方法。在这里，我们定义了一个 <code>handleChange</code> 方法，这个方法会调用 <code>this.props.onChange</code>。然后，我们就用方法来订阅 jQuery 的 <code>change</code> 事件：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">$el</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">chosen</span><span class="p">();</span>

<span class="hll">  <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class="hll">  <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">);</span>
</span><span class="p">}</span>

<span class="nx">componentWillUnmount</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">  <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">);</span>
</span>  <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">chosen</span><span class="p">(</span><span class="s1">&#39;destroy&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="hll"><span class="nx">handleChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">  <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">onChange</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
</span><span class="hll"><span class="p">}</span>
</span></code></pre></div>
<p><a href="http://codepen.io/gaearon/pen/bWgbeE?editors=0010">CodePen 上的示例</a></p>

<p>最后，我们还剩下一件事要做。正如上面提到的，在 React 中，props 可以随时改变。举个例子，如果 <code>&lt;Chosen&gt;</code> 组件父级元素的 state 改变了，那么 <code>&lt;Chosen&gt;</code> 组件里面的 DOM 节点也很可能发生变化。这也就意味着，在集成插件的时候，如果 props 发生了改变，那我们就需要手动更新 DOM 元素，这是因为我们之前已经保证过 React 不会去处理这个节点。</p>

<p>Chosen 插件的文档中提到，我们可以用 jQuery 的 <code>trigger()</code> 方法来更新 Chosen 中的 DOM 元素。那么，我们可以让 React 负责处理 <code>&lt;select&gt;</code> 中的 <code>this.props.children</code>，然后用 <code>componentDidUpdate()</code> 来通知 Chosen 去更新节点的 DOM 元素：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="nx">componentDidUpdate</span><span class="p">(</span><span class="nx">prevProps</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">  <span class="k">if</span> <span class="p">(</span><span class="nx">prevProps</span><span class="p">.</span><span class="nx">children</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;chosen:updated&quot;</span><span class="p">);</span>
</span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>这样一来，Chosen 插件就可以在 React 获取到 <code>&lt;select&gt;</code> 子元素变化的时候去更新 DOM 元素了。</p>

<p>我们把上面提到的内容结合起来，<code>Chosen</code> 组件的最终代码如下：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kr">class</span> <span class="nx">Chosen</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$el</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">chosen</span><span class="p">();</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">componentDidUpdate</span><span class="p">(</span><span class="nx">prevProps</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">prevProps</span><span class="p">.</span><span class="nx">children</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;chosen:updated&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">componentWillUnmount</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">chosen</span><span class="p">(</span><span class="s1">&#39;destroy&#39;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">handleChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">onChange</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">select</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;Chosen-select&quot;</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">el</span> <span class="o">=</span> <span class="nx">el</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="err">/select&gt;</span>
      <span class="o">&lt;</span><span class="err">/div&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><a href="http://codepen.io/gaearon/pen/xdgKOz?editors=0010">CodePen 上的示例</a></p>

<h2>在 React 中使用其他引擎加载页面</h2>

<p>由于 <a href="/react/docs/react-dom.html#render"><code>ReactDOM.reander()</code></a> 方法很灵活，因此我们可以将 React 与其他处理页面显示的库结合使用。</p>

<p>通常来说，尽管 React 是在页面加载的时候把一个根组件放到 DOM 里，但 <code>ReactDOM.render()</code> 方法也可以被不同的 UI 部件多次调用。这个部件可以仅仅是一个按钮，或者也可以是一个应用。</p>

<p>事实上，Facebook 就是这么使用 React 的。我们可以独立地开发每一个部件，然后把这些部件与服务端创建的模板以及客户端代码结合起来，这样就形成了一个完整的应用。</p>

<h3>在 React 中使用“字符串替换”类的库</h3>

<p>早起的网页应用中，一个常用的方式是先把内容定义成字符串片段，然后插入到 DOM 节点中，就像这样：<code>$el.html(htmlString)</code>。采用这种方式写出来的应用，其实非常适合引入 React。只需要把那些字符串定义成 React 组件就可以了。</p>

<p>比如，这一段 jQuery 代码……</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#container&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&lt;button id=&quot;btn&quot;&gt;Say Hello&lt;/button&gt;&#39;</span><span class="p">);</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#btn&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Hello!&#39;</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
<p>……可以改写成这样的 React 组件：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kd">function</span> <span class="nx">Button</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;btn&quot;</span><span class="o">&gt;</span><span class="nx">Say</span> <span class="nx">Hello</span><span class="o">&lt;</span><span class="err">/button&gt;;</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">Button</span> <span class="o">/&gt;</span><span class="p">,</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;container&#39;</span><span class="p">),</span>
  <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#btn&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Hello!&#39;</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">);</span>
</code></pre></div>
<p>那么现在开始，你就可以在这个组件中应用 React 的思路，加入更多的逻辑代码。比如，习惯上来说组件是不应该依赖 ID 的，因为这一个组件可能会显示很多次。因此，我们需要使用 <a href="/react/docs/handling-events.html">React 事件系统</a> 来给 <code>&lt;button&gt;</code> 添加点击事件的回调</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kd">function</span> <span class="nx">Button</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">onClick</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Say</span> <span class="nx">Hello</span><span class="o">&lt;</span><span class="err">/button&gt;;</span>
</span><span class="p">}</span>

<span class="kd">function</span> <span class="nx">HelloButton</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">  <span class="kd">function</span> <span class="nx">handleClick</span><span class="p">()</span> <span class="p">{</span>
</span>    <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Hello!&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="hll">  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">Button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">;</span>
</span><span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">HelloButton</span> <span class="o">/&gt;</span><span class="p">,</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;container&#39;</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<p><a href="http://codepen.io/gaearon/pen/RVKbvW?editors=1010">CodePen 上的示例</a></p>

<p>像这样的独立组件，你可以在页面中尽情使用，数量不限，只需要通过 <code>ReactDOM.render()</code> 方法把它放到不同位置就可以了。随着你把越来越多的代码转成 React 组件，你就可以把这些组件合并成更大的组件。这时候你再使用 <code>ReactDOM.render()</code> 就会输出更多的元素了。</p>

<h3>在 React 中使用 Backbone 的视图</h3>

<p><a href="http://backbonejs.org/">Backbone</a> 的视图是很典型的 HTML 字符串，或者说是通过模板生成 DOM 元素的函数。这个过程同样可以替换成 React 组件中的 render 方法。</p>

<p>现在我们来创建一个叫做 <code>ParagraphView</code> 的 Backbone 视图，然后我们要覆盖 Backbone 原有的 <code>render()</code> 方法，让 Backbone 中 (<code>this.el</code>) 创建的 DOM 元素加载 React 的 <code>&lt;Paragraph&gt;</code> 组件：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="hll"><span class="kd">function</span> <span class="nx">Paragraph</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span>  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;;</span>
<span class="p">}</span>

<span class="hll"><span class="kr">const</span> <span class="nx">ParagraphView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">text</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">);</span>
<span class="hll">    <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Paragraph</span> <span class="nx">text</span><span class="o">=</span><span class="p">{</span><span class="nx">text</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">);</span>
</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">remove</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">    <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">unmountComponentAtNode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">);</span>
</span>    <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">remove</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p><a href="http://codepen.io/gaearon/pen/gWgOYL?editors=0010">CodePen 上的示例</a></p>

<p>请注意，我们在 <code>remove</code> 中调用了 <code>ReactDOM.unmountComponentAtNode()</code>。这样 React 就会在恰当的时候把事件处理器和相关的绑定方法从组件树中删除。</p>

<p>当一个组件被 React 从树中删除，在这个组件上绑定的监听器之类的也会被清除掉。但由于我们是在手动操作这些，因此需要调用相关方法。</p>

<h2>在 React 中使用其他数据层库和框架</h2>

<p>一般来说，推荐大家使用符合单向数据流的框架和库，比如 <a href="/react/docs/lifting-state-up.html">React state</a>、<a href="http://facebook.github.io/flux/">Flux</a> 或 <a href="http://redux.js.org/">Redux</a>。但 React 的组件也可以支持其他处理数据流的框架和库。</p>

<h3>在 React 组件中使用 Backbone 处理数据</h3>

<p>如果想在 React 中使用 <a href="http://backbonejs.org/">Backbone</a> 处理数据模型，最简单的实现方式就是监听多个事件，然后手动调用方法，强制更新页面。</p>

<p>负责处理数据模型的组件通常都会监听 <code>&#39;change&#39;</code> 事件，但负责处理数据本身的组件还要监听 <code>&#39;add&#39;</code> 和 <code>&#39;remove&#39;</code> 事件。无论对于哪种，我们都可以通过调用 <a href="/react/docs/react-component.html#forceupdate"><code>this.forceUpdate()</code></a> 来强制更新页面显示的数据。</p>

<p>在接下来的例子中，<code>List</code> 组件用来显示来自 Backbone 的数据，而 <code>Item</code> 组件是负责显示每一条数据的。</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="hll"><span class="kr">class</span> <span class="nx">Item</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span>  <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>

<span class="hll">  <span class="nx">handleChange</span><span class="p">()</span> <span class="p">{</span>
</span><span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">forceUpdate</span><span class="p">();</span>
</span><span class="hll">  <span class="p">}</span>
</span>
  <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">);</span>
</span>  <span class="p">}</span>

  <span class="nx">componentWillUnmount</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">);</span>
</span>  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)}</span><span class="o">&lt;</span><span class="err">/li&gt;;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="hll"><span class="kr">class</span> <span class="nx">List</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span>  <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">();</span>
  <span class="p">}</span>

<span class="hll">  <span class="nx">handleChange</span><span class="p">()</span> <span class="p">{</span>
</span><span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">forceUpdate</span><span class="p">();</span>
</span><span class="hll">  <span class="p">}</span>
</span>
  <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="s1">&#39;remove&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">);</span>
</span>  <span class="p">}</span>

  <span class="nx">componentWillUnmount</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="s1">&#39;remove&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">);</span>
</span>  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">model</span> <span class="o">=&gt;</span> <span class="p">(</span>
<span class="hll">          <span class="o">&lt;</span><span class="nx">Item</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">model</span><span class="p">.</span><span class="nx">cid</span><span class="p">}</span> <span class="nx">model</span><span class="o">=</span><span class="p">{</span><span class="nx">model</span><span class="p">}</span> <span class="o">/&gt;</span>
</span>        <span class="p">))}</span>
      <span class="o">&lt;</span><span class="err">/ul&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><a href="http://codepen.io/gaearon/pen/GmrREm?editors=0010">CodePen 上的示例</a></p>

<h3>从 Backbone 的数据模型中提取数据</h3>

<p>上面的方法需要 React 组件实时获取 Backbone 数据的更新。如果将来你打算迁移到另一个数据管理系统，你肯定不愿意在 Backbone 这里改动太多的代码。</p>

<p>一种解决方案就是在数据变化时，提取出数据模型的属性，并把这个逻辑封装起来。这里有个 <a href="/react/docs/higher-order-components.html">高阶组件</a> 的例子，作用就是把 Backbone 数据模型中的属性提取出来成为 state，并把数据传到组件中。</p>

<p>采用这种写法，只有这个高阶组件需要实时获取到 Backbone 数据模型的更新，应用中的其他组件都不需要与 Backbone 互动。</p>

<p>在下面的例子中，我们会把数据模型的属性复制到初始 state 中。然后我们会订阅 <code>change</code> 事件（当然，我们也要在组件移除的时候取消订阅）。<code>change</code> 事件触发的时候，我们会根据数据模型当前的属性来更新 state。最后，我们还要确认一件事，就是在 <code>model</code> 这个 prop 本身发生变化的时候，我们同样要取消原来的订阅，同时订阅更新后的 prop。</p>

<p>请注意，这个例子的目的不在于详细说明如何与 Backbone 集成，而是想给出一些通用的思路，这样你也可以试着与其他库或框架集成。</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="hll"><span class="kd">function</span> <span class="nx">connectToBackboneModel</span><span class="p">(</span><span class="nx">WrappedComponent</span><span class="p">)</span> <span class="p">{</span>
</span>  <span class="k">return</span> <span class="kr">class</span> <span class="nx">BackboneComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
<span class="hll">      <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="nx">props</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">attributes</span><span class="p">);</span>
</span>      <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">      <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">);</span>
</span>    <span class="p">}</span>

    <span class="nx">componentWillReceiveProps</span><span class="p">(</span><span class="nx">nextProps</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">      <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="nx">nextProps</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">attributes</span><span class="p">));</span>
</span>      <span class="k">if</span> <span class="p">(</span><span class="nx">nextProps</span><span class="p">.</span><span class="nx">model</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">);</span>
</span><span class="hll">        <span class="nx">nextProps</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">);</span>
</span>      <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">componentWillUnmount</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">      <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">);</span>
</span>    <span class="p">}</span>

    <span class="nx">handleChange</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">      <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">changedAttributes</span><span class="p">());</span>
</span>    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">propsExceptModel</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">);</span>
      <span class="k">delete</span> <span class="nx">propsExceptModel</span><span class="p">.</span><span class="nx">model</span><span class="p">;</span>
<span class="hll">      <span class="k">return</span> <span class="o">&lt;</span><span class="nx">WrappedComponent</span> <span class="p">{...</span><span class="nx">propsExceptModel</span><span class="p">}</span> <span class="p">{...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">;</span>
</span>    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>为了展示如何调用，我们在 Backbone 模型中引入一个叫做 <code>NameInput</code> 的 React 组件。当输入发生变化时更新组件的 <code>firstName</code> 属性。</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kd">function</span> <span class="nx">NameInput</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
<span class="hll">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">firstName</span><span class="p">}</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">}</span> <span class="o">/&gt;</span>
</span>      <span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
<span class="hll">      <span class="nx">My</span> <span class="nx">name</span> <span class="nx">is</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">firstName</span><span class="p">}.</span>
</span>    <span class="o">&lt;</span><span class="err">/p&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>

<span class="hll"><span class="kr">const</span> <span class="nx">BackboneNameInput</span> <span class="o">=</span> <span class="nx">connectToBackboneModel</span><span class="p">(</span><span class="nx">NameInput</span><span class="p">);</span>
</span>
<span class="kd">function</span> <span class="nx">Example</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">function</span> <span class="nx">handleChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">    <span class="nx">model</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;firstName&#39;</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
</span>  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span>
<span class="hll">    <span class="o">&lt;</span><span class="nx">BackboneNameInput</span>
</span><span class="hll">      <span class="nx">model</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">model</span><span class="p">}</span>
</span><span class="hll">      <span class="nx">handleChange</span><span class="o">=</span><span class="p">{</span><span class="nx">handleChange</span><span class="p">}</span>
</span>    <span class="o">/&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span><span class="p">({</span> <span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Frodo&#39;</span> <span class="p">});</span>
<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">Example</span> <span class="nx">model</span><span class="o">=</span><span class="p">{</span><span class="nx">model</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">,</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<p><a href="http://codepen.io/gaearon/pen/PmWwwa?editors=0010">CodePen 上的示例</a></p>

<p>以上提到的内容不局限于 Backbone。对于任何处理数据模型的库或框架，你都可以在 React 中通过生命周期函数订阅它的变化事件。你还可以把这些数据直接复制到 React 组件的 state 中，不过这个步骤不是必须的。</p>


    <div class="docs-prevnext">
      
      
    </div>
  </div>

  <div class="nav-docs">
  <!-- Docs Nav -->
  
    <div class="nav-docs-section">
      <h3>快速开始</h3>
      <ul>
        
          <li>
            <a href="/react/docs/installation.html">安装</a>
            
          </li>
        
          <li>
            <a href="/react/docs/hello-world.html">Hello World</a>
            
          </li>
        
          <li>
            <a href="/react/docs/introducing-jsx.html">JSX 简介</a>
            
          </li>
        
          <li>
            <a href="/react/docs/rendering-elements.html">元素渲染</a>
            
          </li>
        
          <li>
            <a href="/react/docs/components-and-props.html">组件 & Props</a>
            
          </li>
        
          <li>
            <a href="/react/docs/state-and-lifecycle.html">State & 生命周期</a>
            
          </li>
        
          <li>
            <a href="/react/docs/handling-events.html">事件处理</a>
            
          </li>
        
          <li>
            <a href="/react/docs/conditional-rendering.html">条件渲染</a>
            
          </li>
        
          <li>
            <a href="/react/docs/lists-and-keys.html">列表 & Keys</a>
            
          </li>
        
          <li>
            <a href="/react/docs/forms.html">表单</a>
            
          </li>
        
          <li>
            <a href="/react/docs/lifting-state-up.html">状态提升</a>
            
          </li>
        
          <li>
            <a href="/react/docs/composition-vs-inheritance.html">组合 vs 继承</a>
            
          </li>
        
          <li>
            <a href="/react/docs/thinking-in-react.html">React 理念</a>
            
          </li>
        
      </ul>
    </div>
  
    <div class="nav-docs-section">
      <h3>高级指引</h3>
      <ul>
        
          <li>
            <a href="/react/docs/jsx-in-depth.html">深入 JSX</a>
            
          </li>
        
          <li>
            <a href="/react/docs/typechecking-with-proptypes.html">使用 PropTypes 检查类型</a>
            
          </li>
        
          <li>
            <a href="/react/docs/refs-and-the-dom.html">Refs & DOM</a>
            
          </li>
        
          <li>
            <a href="/react/docs/uncontrolled-components.html">非受控组件</a>
            
          </li>
        
          <li>
            <a href="/react/docs/optimizing-performance.html">性能优化</a>
            
          </li>
        
          <li>
            <a href="/react/docs/react-without-es6.html">不使用 ES6</a>
            
          </li>
        
          <li>
            <a href="/react/docs/react-without-jsx.html">不使用 JSX</a>
            
          </li>
        
          <li>
            <a href="/react/docs/reconciliation.html">Reconciliation</a>
            
          </li>
        
          <li>
            <a href="/react/docs/context.html">Context</a>
            
          </li>
        
          <li>
            <a href="/react/docs/web-components.html">Web Components</a>
            
          </li>
        
          <li>
            <a href="/react/docs/higher-order-components.html">高阶组件</a>
            
          </li>
        
          <li>
            <a href="/react/docs/integrating-with-other-libraries.html" class="active">与第三方库协同</a>
            
          </li>
        
      </ul>
    </div>
  
    <div class="nav-docs-section">
      <h3>参考</h3>
      <ul>
        
          <li>
            <a href="/react/docs/react-api.html">React</a>
            
              <ul>
                
                  <li>
                    <a href="/react/docs/react-component.html">React.Component</a>
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="/react/docs/react-dom.html">ReactDOM</a>
            
          </li>
        
          <li>
            <a href="/react/docs/react-dom-server.html">ReactDOMServer</a>
            
          </li>
        
          <li>
            <a href="/react/docs/dom-elements.html">DOM Elements</a>
            
          </li>
        
          <li>
            <a href="/react/docs/events.html">SyntheticEvent</a>
            
          </li>
        
      </ul>
    </div>
  

  <!-- Contributing Nav -->
  
    <div class="nav-docs-section">
      <h3>Contributing</h3>
      <ul>
        
          <li>
            <a href="/react/contributing/how-to-contribute.html">How to Contribute</a>
          </li>
        
          <li>
            <a href="/react/contributing/codebase-overview.html">Codebase Overview</a>
          </li>
        
          <li>
            <a href="/react/contributing/implementation-notes.html">Implementation Notes</a>
          </li>
        
          <li>
            <a href="/react/contributing/design-principles.html">Design Principles</a>
          </li>
        
      </ul>
    </div>
  

</div>

</section>


    <footer class="nav-footer">
  <section class="sitemap">
    <a href="/react/" class="nav-home">
    </a>
    <div>
      <h5><a href="/react/docs/">文档</a></h5>
      <a href="/react/docs/hello-world.html">快速开始</a>
      <a href="/react/docs/thinking-in-react.html">React 理念</a>
      <a href="/react/tutorial/tutorial.html">上手教程</a>
      <a href="/react/docs/jsx-in-depth.html">高级指引</a>
    </div>
    <div>
      <h5><a href="/react/community/support.html">社区</a></h5>
      <a href="http://stackoverflow.com/questions/tagged/reactjs" target="_blank">Stack Overflow</a>
      <a href="https://discuss.reactjs.org/" target="_blank">论坛</a>
      <a href="https://discord.gg/0ZcbPKXt5bZjGY5n" target="_blank">Reactiflux Chat</a>
      <a href="https://www.facebook.com/react" target="_blank">Facebook</a>
      <a href="https://twitter.com/reactjs" target="_blank">Twitter</a>
    </div>
    <div>
      <h5><a href="/react/community/support.html">资源</a></h5>
      <a href="/react/community/conferences.html">讨论会</a>
      <a href="/react/community/videos.html">视频</a>
      <a href="https://github.com/facebook/react/wiki/Examples" target="_blank">示例</a>
      <a href="https://github.com/facebook/react/wiki/Complementary-Tools" target="_blank">开发工具</a>
    </div>
    <div>
      <h5>更多</h5>
      <a href="/react/blog/">博客</a>
      <a href="https://github.com/facebook/react" target="_blank">GitHub</a>
      <a href="http://facebook.github.io/react-native/" target="_blank">React Native</a>
      <a href="/react/acknowledgements.html">致谢</a>
    </div>
  </section>
  <a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource">
    <img src="/react/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/>
  </a>
  <section class="copyright">
    Copyright © 2017 Facebook Inc.
      <br />
    <a href="https://zhuanlan.zhihu.com/icode">从零学习前端开发</a>翻译组
  </section>
</footer>

  </div>

  <div id="fb-root"></div>
  <script src="/react/js/anchor-links.js"></script>
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?c98750dd376fe6b44c1b507c53c7bbba";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
  </script>
  <script>
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");

    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.6&appId=623268441017527";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

    docsearch({
      apiKey: '36221914cce388c46d0420343e0bb32e',
      indexName: 'react',
      inputSelector: '#algolia-doc-search'
    });
  </script>
</body>
</html>
